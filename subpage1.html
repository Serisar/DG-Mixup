<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Subpage 1</title>

  <!-- Include Material Design Lite CSS -->
  <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-pink.min.css">
  <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>

  <!-- Google Fonts for icons -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">

  <style>
    .page-content {
      padding: 16px;
    }
    .entry-list {
      margin-top: 20px;
    }
    .entry-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 10px;
      padding: 10px;
      border: 1px solid #E0E0E0;
      border-radius: 5px;
      transition: background-color 0.3s;
    }
    .edit-icon {
      cursor: pointer;
      color: #3F51B5;
    }
    .circle-number {
      display: inline-block;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      background-color: #3F51B5;
      color: white;
      text-align: center;
      line-height: 30px;
      margin-right: 10px;
    }
    .shuffled-number {
      background-color: #FFC107; /* Different color for shuffled number */
    }
    .hidden {
      display: none;
    }
    .icon-button {
      position: absolute;
      top: 16px;
      left: 16px;
    }
    .greyed-out {
      background-color: #E0E0E0;
      color: #9E9E9E;
    }
    .arrow {
      margin-left: 10px;
      margin-right: 10px;
    }
  </style>
</head>
<body>

  <!-- Header with Return to Homepage (House Icon) -->
  <header class="mdl-layout__header">
    <div class="mdl-layout__header-row">
      <div class="icon-button">
        <a href="index.html" class="mdl-button mdl-js-button mdl-button--icon">
          <i class="material-icons">home</i>
        </a>
      </div>
      <span class="mdl-layout-title">Subpage 1</span>
    </div>
  </header>

  <!-- Page content -->
  <main class="mdl-layout__content">
    <div class="page-content">
      <h4>Enter Alphanumeric String</h4>

      <!-- Text input field and Add button -->
      <div id="input-section">
        <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
          <input class="mdl-textfield__input" type="text" id="entryInput">
          <label class="mdl-textfield__label" for="entryInput">Enter a string...</label>
        </div>
        <button id="addEntry" class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored">
          Add
        </button>
      </div>

      <!-- List of entries -->
      <div class="entry-list" id="entryList"></div>

      <!-- Confirm button -->
      <button id="confirmEntries" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent">
        Confirm All Entries
      </button>

      <!-- Shuffle button (hidden initially) -->
      <button id="shuffleEntries" class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored hidden">
        Shuffle
      </button>

    </div>
  </main>

  <script>
    let entries = [];
    let excludedIndices = new Set(); // To track excluded entries
    const entryInput = document.getElementById('entryInput');
    const entryList = document.getElementById('entryList');
    const confirmButton = document.getElementById('confirmEntries');
    const shuffleButton = document.getElementById('shuffleEntries');

    // Function to add a new entry
    document.getElementById('addEntry').addEventListener('click', addEntry);
    entryInput.addEventListener('keypress', function(event) {
      if (event.key === 'Enter') {
        addEntry();
      }
    });

    function addEntry() {
      const value = entryInput.value.trim();
      if (value) {
        entries.push(value);
        displayEntries();
        entryInput.value = '';  // Clear the input field after entry
      }
    }

    // Function to display the entries in the list
    function displayEntries() {
      entryList.innerHTML = '';  // Clear the existing list
      entries.forEach((entry, index) => {
        const entryItem = document.createElement('div');
        entryItem.className = 'entry-item';

        const entryNumber = document.createElement('div');
        entryNumber.className = 'circle-number';
        entryNumber.innerText = index + 1;

        const entryText = document.createElement('span');
        entryText.innerText = entry;

        const editButton = document.createElement('i');
        editButton.className = 'material-icons edit-icon';
        editButton.innerText = 'edit';
        editButton.addEventListener('click', function() {
          editEntry(index);
        });

        // Exclude entry from shuffle when clicked/tapped
        entryItem.addEventListener('click', function() {
          toggleExclude(index, entryItem);
        });

        entryItem.appendChild(entryNumber);
        entryItem.appendChild(entryText);
        entryItem.appendChild(editButton);
        entryList.appendChild(entryItem);
      });
    }

    // Function to edit an entry
    function editEntry(index) {
      const newEntry = prompt('Edit the entry:', entries[index]);
      if (newEntry !== null) {
        entries[index] = newEntry.trim();  // Update the entry
        displayEntries();  // Refresh the list
      }
    }

    // Confirm all entries and disable input, remove edit buttons, and add numbers
    confirmButton.addEventListener('click', function() {
      document.getElementById('input-section').classList.add('hidden');  // Hide the input section
      confirmButton.classList.add('hidden');  // Hide the confirm button

      // Remove edit buttons and add numbers to entries
      entryList.innerHTML = '';  // Clear the list for re-rendering
      entries.forEach((entry, index) => {
        const entryItem = document.createElement('div');
        entryItem.className = 'entry-item';

        const entryNumber = document.createElement('div');
        entryNumber.className = 'circle-number';
        entryNumber.innerText = index + 1;

        const entryText = document.createElement('span');
        entryText.innerText = entry;

        entryItem.appendChild(entryNumber);
        entryItem.appendChild(entryText);
        entryList.appendChild(entryItem);

        // Exclude entry from shuffle when clicked/tapped
        entryItem.addEventListener('click', function() {
          toggleExclude(index, entryItem);
        });
      });

      shuffleButton.classList.remove('hidden');  // Show the shuffle button
    });

    // Shuffle the entries and assign random numbers to them
    shuffleButton.addEventListener('click', function() {
      const availableIndices = [...Array(entries.length).keys()].filter(i => !excludedIndices.has(i));
      const shuffledNumbers = shuffleArray(availableIndices.map(x => x + 1));  // Shuffle only non-excluded entries

      const entryItems = document.querySelectorAll('.entry-item');
      entryItems.forEach((item, index) => {
        const arrow = item.querySelector('.arrow');
        if (arrow) {
          arrow.remove();  // Remove old arrows if any
        }
        const shuffledDisplay = item.querySelector('.shuffled-number');
        if (shuffledDisplay) {
          shuffledDisplay.remove();  // Remove old shuffled number if any
        }

        if (!excludedIndices.has(index)) {
          const newArrow = document.createElement('span');
          newArrow.className = 'arrow';
          newArrow.innerText = 'â†’';

          const shuffledNumber = document.createElement('div');
          shuffledNumber.className = 'circle-number shuffled-number';
          shuffledNumber.innerText = shuffledNumbers.shift();  // Assign shuffled number

          item.appendChild(newArrow);
          item.appendChild(shuffledNumber);
        }
      });
    });

    // Toggle exclusion of entry from shuffle
    function toggleExclude(index, entryItem) {
      if (excludedIndices.has(index)) {
        excludedIndices.delete(index);
        entryItem.classList.remove('greyed-out');
      } else {
        excludedIndices.add(index);
        entryItem.classList.add('greyed-out');
      }
    }

    // Helper function to shuffle an array (Fisher-Yates shuffle)
    function shuffleArray(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }
  </script>

</body>
</html>
